<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>

   
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="PiWBL" />
    <meta name="description" content="FOI" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="css/glavni.css" />
    <link rel="stylesheet" href="css/pocetnaStranica.css" />
    <script type="module" src="./index.js"></script>
    <script>
    const odredeniParkingSpaces = async () => {
      var idSpacea = document.getElementById("parkirniSpaceovi").value;
      const response = await fetch(
        "https://localhost:7236/api/Parking/specificParkingSpace?id=" + idSpacea,
        {
          method: "GET",
          headers: {
            "Content-Type": "application/json",
          },
        }
      );
      const myJson = await response.json();

      return myJson;
    };

    function prikazi() {
      var idSpacea = document.getElementById("parkirniSpaceovi").value;
      console.log(idSpacea);
      Promise.allSettled([odredeniParkingSpaces()]).then((parkirniSpaceovi2) => {
        $(function () {
          var park = parkirniSpaceovi2[0];
          var valueParkingSpacea = park[Object.keys(park)[1]];
          console.log(valueParkingSpacea[0]);
          pokaziNaKarti(valueParkingSpacea[0].pspLatitude, valueParkingSpacea[0].pspLongitude)
        });
      });
    }

    function pokaziNaKarti(lat, lng){
      const uluru = { lat: lat, lng: lng };
      const map = new google.maps.Map(document.getElementById("map"), {
        zoom: 18,
        center: uluru,
      });
      map.setCenter(new google.maps.LatLng(lat, lng, 2));
    }
    </script>
    <title>Parkirna mjesta</title>
  </head>
  <body>
    <nav id="navigacija">
      <a id="trenutni" href="#">POČETNA</a>
      <a href="statistika.html">STATISTIKA</a>
      <a href="obrasci/prijava.html">PRIJAVA</a>
      <a id="trenutniRegistracija" href="obrasci/registracija.html"
        >REGISTRACIJA</a
      >
    </nav>
    <div style="margin-top: -20px;display: flex; justify-content: space-evenly;">
      <div class="smallitem">
        <label
          style="
            margin-left: 40%;
            padding-right: 10px;
            color: #b3b3b3;
            font-size: 19px;
          "
        >
          Odaberite parking space:
        </label>
        <form onsubmit="prikazi()" id="mojaForma" name="mojaForma" style="margin-left: 40%; margin-top:20px;">
          <select name="parkingSpace" id="parkirniSpaceovi">
          </select>
          <input type="submit" value="Prikaži" style="width:100px;"></input>
        </form>
      </div>
      <div class="bigitem">
      <label
        style="
          margin-left: 19px;
          padding-right: 10px;
          color: #b3b3b3;
          font-size: 19px;
        "
      >
        Ukupan broj mjesta:
      </label>
      <label
        style="
          margin-left: 59px;
          padding-right: 10px;
          color: #b3b3b3;
          font-size: 19px;
        "
      >
        Broj slobodnih mjesta:
      </label>
      <label
        style="
          margin-left: 41px;
          padding-right: 10px;
          color: #b3b3b3;
          font-size: 19px;
        "
      >
        Broj zauzetih mjesta:
      </label>
      <label
        style="
          margin-left: 51px;
          padding-right: 10px;
          color: #b3b3b3;
          font-size: 19px;
        "
      >
        Odaberite datum:
      </label>
      <br /><br />
      
      <input
        type="text"
        id="ukupanBrojMjestaPocetna"
        name="ukupanBrojMjestaPocetna"
        style="margin-left: 10px; padding-right: 10px"
      />

      <input
        type="text"
        id="brojSlobodnihMjestaPocetna"
        name="brojSlobodnihMjestaPocetna"
        style="
          margin-left: 15px;
          padding-right: 10px;
          background-color: rgb(112, 168, 112);
        "
      />
      <input
        type="text"
        id="brojZauzetihhMjestaPocetna"
        name="brojZauzetihMjestaPocetna"
        style="
          margin-left: 15px;
          padding-right: 10px;
          background-color: rgb(165, 80, 80);
        "
      />
      <input
        type="datetime-local"
        id="datumPocetna"
        name="datumPocetna"
        onchange="initMap()"
        value="2021-01-01T00:00"
        style="margin-left: 15px; padding-right: 25px"
      />
    </div>
  </div>
    <div
      id="map"
      style="margin-right: 11%; margin-top: -65px; margin-right: 20px"
    ></div>
    <!-- </div> -->
    <link rel="stylesheet" type="text/css" href="./style.css" />
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCfMa5FbvPRXZMN_ItcASp8qvXM74buvgA&callback=initMap&v=weekly"
      defer
    ></script>
  </body>
</html>
