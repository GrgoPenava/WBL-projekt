<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <script type="module" src="./statistika.js"></script>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="author" content="PiWBL" />
  <meta name="description" content="FOI" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="css/glavni.css" />
  <link rel="stylesheet" href="css/katalog.css" />
  <title>Statistika</title>
</head>

<body id="tijeloPrijave">
  <nav id="navigacija">
    <a href="index.html">POČETNA</a>
    <a id="trenutni" href="#">STATISTIKA</a>
    <a href="obrasci/prijava.html">PRIJAVA</a>
    <a id="trenutniRegistracija" href="obrasci/registracija.html">REGISTRACIJA</a>
  </nav>

  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.js"></script>
    <title>Statistika</title>
    <input type="hidden" name="smname" id="id" />
    <script>

      const userAction2 = async () => {
        const response2 = await fetch('https://localhost:7236/api/Statistika/randomSenzori', {
          method: 'GET',
          // body: myBody, // string or object
          headers: {
            'Content-Type': 'application/json'
          }
        });
        const myJson2 = await response2.json(); //extract JSON from the http response
        // do something with myJson

        return myJson2;

      }

      document.addEventListener("DOMContentLoaded", function (event) {
        Promise.any([userAction2()])
          .then(podaci2 => {
            /* for (var j = 0; j < podaci2.length - 1; j++) { */
            /* console.log("podaci2[j]", podaci2[j]);
            console.log("SENZOR - ",podaci2[0].snrNbpsBatteryLevel); */
            $(function () {
              var x = 0;
              new Chart(document.getElementById("prvi"), {
                type: 'bar',
                data: {
                  labels: ["Senzor ID:" + podaci2[x].snrSensorId, "Senzor ID:" + podaci2[x + 1].snrSensorId, "Senzor ID:" + podaci2[x + 2].snrSensorId, "Senzor ID:" + podaci2[x + 3].snrSensorId, "Senzor ID:" + podaci2[x + 4].snrSensorId, "Senzor ID:" + podaci2[x + 5].snrSensorId, "Senzor ID:" + podaci2[x + 6].snrSensorId, "Senzor ID:" + podaci2[x + 7].snrSensorId, "Senzor ID:" + podaci2[x + 8].snrSensorId, "Senzor ID:" + podaci2[x + 9].snrSensorId,],
                  datasets: [
                    {
                      label: "Battery",
                      backgroundColor: "#3e95cd",

                      data: [podaci2[x].snrNbpsBatteryLevel, podaci2[x + 1].snrNbpsBatteryLevel, podaci2[x + 2].snrNbpsBatteryLevel, podaci2[x + 3].snrNbpsBatteryLevel, podaci2[x + 4].snrNbpsBatteryLevel, podaci2[x + 5].snrNbpsBatteryLevel, podaci2[x + 6].snrNbpsBatteryLevel, podaci2[x + 7].snrNbpsBatteryLevel, podaci2[x + 8].snrNbpsBatteryLevel, podaci2[x + 9].snrNbpsBatteryLevel,]
                    }
                  ]
                },
                options: {
                  legend: { display: false },
                  title: {
                    display: true,
                    text: 'Prikaz random senzora i njihove baterije'
                  },

                }
              });
            })
            /* } */
          })
          .catch(error => {
            console.error("Failed to fetch2")
          });
      });


      const userAction = async () => {
        const response = await fetch('https://localhost:7236/api/Statistika/tipParkirnihMjesta', {
          method: 'GET',
          // body: myBody, // string or object
          headers: {
            'Content-Type': 'application/json'
          }
        });
        const myJson = await response.json(); //extract JSON from the http response
        // do something with myJson

        return myJson;

      }

      Promise.any([userAction()])
        .then(datas => {
          for (var i = 0; i < datas.length; i++) {
            console.log("datas[i]", datas[i]);
            varijabla1 = datas[i].split(";");
            console.log(" test0 - ", varijabla1[0]);
            console.log(" test1 - ", varijabla1[1]);
            //var varijabla2 = datas[0];
            $(function () {

              /*  new Chart(document.getElementById("prvi"), {
                 type: 'bar',
                 data: {
                   labels: ["6342"+"a", "Asia", "Europe", "Latin America", "North America", "6342", "Asia", "Europe", "Latin America", "North America", "6342", "Asia", "Europe", "Latin America", "North America"],
                   datasets: [
                     {
                       label: "Population (millions)",
                       backgroundColor: "#3e95cd",
                       
                       data: [5, 6, 7, 8, 10, 5, 6, 7, 8, 10, 5, 6, 7, 8, 10,]
                     }
                   ]
                 },
                 options: {
                   legend: { display: false },
                   title: {
                     display: true,
                     text: 'NASLOV1'
                   },
 
                 }
               }); */


              var ctx_2 = document.getElementById("drugi").getContext('2d');
              var data_2 = {
                datasets: [{
                  data: [varijabla1[0], varijabla1[1]],
                  backgroundColor: [
                    '#3c8dbc',
                    '#f56954',
                    '#f39c12',
                  ],
                }],
                labels: [
                  'Obično parking mjesto',
                  'Invalidsko parking mjesto'
                ]
              };
              var myDoughnutChart_2 = new Chart(ctx_2, {
                type: 'doughnut',
                data: data_2,
                options: {
                  responsive: false,
                  maintainAspectRatio: false,
                  legend: {
                    position: 'bottom',
                    labels: {
                      boxWidth: 12
                    }
                  }
                }
              });

              /* new Chart(document.getElementById("treci"), {
                type: 'bar',
                data: {
                  labels: ["abeceda", "Asia", "Europe", "Latin America", "North America", "Africa", "Asia", "Europe", "Latin America", "North America"],
                  datasets: [
                    {
                      label: "Population (millions)",
                      backgroundColor: "#3e95cd",
                      data: [5, 6, 7, 8, 15, 5, 6, 7, 8, 15]
                    }
                  ]
                },
                options: {
                  legend: { display: false },
                  title: {
                    display: true,
                    text: 'NASLOV1'
                  },

                }
              }); */
            });
          }

        })
        .catch(error => {
          console.error("Failed to fetch")
        });
      /* var ctx_4 = document.getElementById("cetvrti").getContext('2d');
var data_4 = {
datasets: [{
  data: [30, 20, 30],
  backgroundColor: [
    '#3c8dbc',
    '#f56954',
    '#f39c12',
  ],
}],
labels: [
  'ggggg',
  'dva',
  'tri'
]
};
var myDoughnutChart_4 = new Chart(ctx_4, {
type: 'pie',
data: data_2,
options: {
  responsive: false,
  maintainAspectRatio: false,
  legend: {
    position: 'bottom',
    labels: {
      boxWidth: 12
    }
  }
}
}); */


      const userAction3 = async () => {
        const response3 = await fetch('https://localhost:7236/api/Statistika/brojSlobodnihMjestaPoParkirnomSpaceu', {
          method: 'GET',
          // body: myBody, // string or object
          headers: {
            'Content-Type': 'application/json'
          }
        });
        const myJson3 = await response3.json(); //extract JSON from the http response
        // do something with myJson

        return myJson3;

      }

      Promise.any([userAction3()])
        .then(podaci3 => {
          $(function () {
            for (var z = 0; z < 10; z++) {
              console.log("AAAAAAAAAA",podaci3[z]);
              var varijablica1 = podaci3[0].split(";");
              var varijablica2 = podaci3[1].split(";");
              var varijablica3 = podaci3[2].split(";");
              var varijablica4 = podaci3[3].split(";");
              var varijablica5 = podaci3[4].split(";");
              var varijablica6 = podaci3[5].split(";");
              var varijablica7 = podaci3[6].split(";");
              var varijablica8 = podaci3[7].split(";");
              var varijablica9 = podaci3[8].split(";");
              var varijablica10 = podaci3[9].split(";");

              
              new Chart(document.getElementById("treci"), {
                type: 'bar',
                data: {
                  labels: ["Space:"+varijablica1[0],"Space:"+ varijablica2[0], "Space:"+varijablica3[0],"Space:"+ varijablica4[0],"Space:"+ varijablica5[0], "Space:"+varijablica6[0], "Space:"+varijablica7[0],"Space:"+ varijablica8[0], "Space:"+varijablica9[0], "Space:"+varijablica10[0]],
                  datasets: [
                    {
                      label: "Slobodnih parkirnih mjesta",
                      backgroundColor: "#3e95cd",
                      data: [varijablica1[1], varijablica2[1], varijablica3[1], varijablica4[1], varijablica5[1], varijablica6[1], varijablica7[1], varijablica8[1], varijablica9[1], varijablica10[1]]
                    }
                  ]
                },
                options: {
                  legend: { display: false },
                  title: {
                    display: true,
                    text: 'Prikaz parking space-a i broja slobodnih mjesta'
                  },

                }
              });
            }

          })
        });


    </script>
  </head>

  <body>
    <div class="container">
      <div class="klasa1">
        <canvas id="prvi" width="700px" height="240px"></canvas>
      </div>
      <div class="klasa2">
        <canvas id="drugi" width="240px" height="240px"></canvas>
      </div>
      <div class="klasa3">
        <canvas id="treci" width="700px" height="240px"></canvas>
      </div>
    </div>
  </body>
</body>

</html>